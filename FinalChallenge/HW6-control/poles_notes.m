% compute S matrix for first pole eq 21
Sm1 = [(A-p(1)*eye(8)) -B];
% compute nullspace for S compatibility 
Ke1 = null(Sm1);
% Compute linear combination of vectors of nullspace that aligns with
VM1 = Ke1*(Ke1(1:8,1:2)\[1;0;0;0;0;0;0;0]);
v1 = VM1(1:8);
m1 = VM1(9:10);

%% pole placements
[0    4.4475   -4.4975   -0.0500    0.0000   -0.0000         0   -0.0500]
[0.2    -4.4475   -4.4975   -0.0500    -0.5   -0.7         -1   -0.0500] - 4.95%
p = [-1.2    -4.4475   -4.4975   -0.0500    -0.5   -0.7         -1   -0.0500] - 0.3%
[-15.2  -1.4475   -4.4975   -0.0500  -3.5   -2.7  -3   -0.5] - -12%

p = p = [-15.2  -5.4475   -4.4975   -0.500  -0.5   -2.7  -4.0   -3.5]; %THIS GIVES 65%%
%with change in traj, we get 73.533037%!
p = [-15.2382   -5.5377   -4.3416   -0.6719   -0.0019   -2.4971   -3.7963   -3.5184] %THIS GIVES 76.781138%
%changed ref traj, and ran inside optimizer!
[-1.2000   -4.4475   -4.4975   -0.0500   -0.5000   -0.7000   -1.0000   -0.0500]
K = [ ...
   -2.2361   -2.2361   -3.1109   -2.1804   19.2981    8.2189   38.3907    9.8868;
    2.2361   -2.2361    3.1109   -2.1804  -19.2981   -8.2189  -38.3907   -9.8868 ]

s = tf('s')
G = C*(s*eye(8)-A)\B+D;
pole(G)'
Anew = A-B*K;
Gnew = C*(s*eye(8)-Anew)\B+D
poles_new = pole(Gnew)';

p(1) - K(1), K(3), K(5), 

K =

   -0.1025   -0.5000   -0.4299   -1.4500    4.6811    3.0488   20.7687    4.8237
    0.1025   -0.5000    0.4299   -1.4500   -4.6811   -3.0488  -20.7687   -4.8237